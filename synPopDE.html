<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<title>Synthetic Population using German Data</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="description" content="This site was created from a template originally designed and developed by Codify Design Studio. Find more free templates at http://www.adobe.com/devnet/author_bios/chris_converse.html" />
		<link rel="stylesheet" type="text/css" href="stylesheet.css" />
		<script src="SpryAssets/SpryMenuBar.js" type="text/javascript"></script>
		<link href="SpryAssets/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />
	</head>
	<body>
	
		<div class="bannerArea">
			<div class="container">
				<div class="bannernav"><a href="contact.html" >Contact</a></div>
				<div class="toplogo">
                <a href="index.html"><img src="images/siloLogoTown.gif" alt="Silo Logo" height="69"/></a>
                </div>
				<div style="clear:both;"></div>
			</div>
		</div>
		<div class="topnavigationArea">
			<div class="container"> 
				<div class="topnavigationgroup">
					<ul id="MenuBar1" class="MenuBarHorizontal">
                      <li><a href="design.html" class="MenuBarItemSubmenu">Model Design</a>
                        <ul>
                          <li><a href="introduction.html">Introduction</a></li>
                          <li><a href="publications.html">Publications</a></li>
                        </ul>
                      </li>
                      <li><a class="MenuBarItemSubmenu" href="modules.html">Modules</a>
                        <ul>
							<li><a class="MenuBarItemSubmenu" href="synPop.html">Synthetic Population</a>
                            <ul>
                            	<li><a href="synPopDE.html">German data</a></li>
                                <li><a href="synPopUS.html">U.S. data</a></li>
                            </ul></li>
                          <li><a href="hhRelocation.html">Household Relocation</a></li>
                          <li><a href="demography.html">Demography</a></li>
                          <li><a href="realEstate.html">Real Estate</a></li>
                        </ul>
                      </li>
                      <li><a href="data.html" class="MenuBarItemSubmenu">Data</a>
                        <ul>
                          <li><a href="inputData.html">Input Data</a></li>
                          <li><a href="outputData.html" class="MenuBarItemSubmenu">Output Data</a>
                            <ul>
                              <li><a href="validation.html">Model Validation</a></li>
                            </ul>
                          </li>
                        </ul>
                      </li>
<li style="border-right-style: solid;"><a href="team.html">Team</a></li>
					</ul>
				</div>
				<div style="clear:both;"></div>
			</div>
		</div>
		<div class="contentArea">
			<div class="container"> 
				<div class="contentleft">
					<h1>Creating a Synthetic Population with German Data</h1>
					
				  <p> <i> A synthetic population generator for the Metropolitan Area of Munich is currently under development. Using census microdata, municipality-level and county-(called Kreis)-level data, a process called Iterative Proportional Updating is used to generate a synthetic population. A detailed description of the approach is currently under development. </i>
                  </p>
                  <p>Synthetic populations are used in transportation modeling  when individual records are not available due to privacy data, lack of resolution or some attributes. Travel behavior of synthesized individuals is  simulated to evaluate, for example, the effect of building a new shopping mall on the transport network.</p>
                  <p>The objective of population synthesis is to generate a population that matches certain attributes of the total population based on a sample of households. Control attributes can be at the household level, such as household size or number of autos, or at the person level, such as gender, age or employment status. The optimization procedure consists on obtaining how representative is each one of the households of the sample to the total population, given a set of control attributes that act as constraints. </p>
                  <img src="images/populationSynthesis.png" width="660" height="296" alt=""/>
                 

<p>Population synthesis has three phases: </p>
                  <ol>
                    <li>Data preparation</li>
                    <li>Optimization procedure</li>
                    <li>Generation of the synthetic population</li>
                  </ol>
				  <p>&nbsp;</p>
				  <h2>Data preparation</h2>
                  
                  <p>In Germany, statistical information of the population is available online at the <a href="https://www-genesis.destatis.de/genesis/online?operation=sprachwechsel&option=en">GENESIS-Online database</a> . Data are aggregated at the municipality level (Gemeinden), county level (Landkreise), state level (Länder) or Nationwide (Bund). They include information on population, educacion, housing and environment, economic sectors, public finances or economic accounts. </p>
                  <p> For household structures, we can rely on microdata from Household Travel Surveys or Household Census. In Germany, Household Census contains more detail than Household Travel Surveys on how households are structured. The number of records is a 5% sample of the total population, and due to privacy, they can only be linked to the state on which the household is located. Household Census microdata can be purchased from the State Statistical Office. They include household size, household composition or age, gender and employment status of household members.</p>
                  <p> After data are collected, we decide which attributes are going to be matched, or control attributes. Control attributes can be household type or person type. Usual household type attributes are household size, number of autos the household owns, number of workers in the household or household income. Person type attributes refer to the individuals on the household and usually include age, gender, ethnicity or working status.  </p>
                  
                  
                  <img src="images/syntheticPopulation_attributes.png" width="500" height="331" alt=""/>
                  <p>
                  Control attributes must be included on both databases and have transferable categories, which can limit the number of attributes to match. In some cases, total population attributes are not aggregated at the same resolution. Based on the available data, we use 24 control attributes at the municipality level and 5 control attributes at the county level. </p>
                  <p> For the optimization procedure, we need to generate the frequency matrix. The frequency matrix shows the household type and the frequency of different person types within each household for the sample. The dimension of the matrix is N x M, where N is the number of households in the microdata and M is the number of control attributes (household and person type). A 0 or 1 is assigned to household types control attributes and the persons in the household that has that attribute are assigned to person types control attributes.</p>
                  
                  <p>&nbsp;</p>                 
                  <h2>Optimization procedure</h2>
                  <p>The synthetic population is generated using Iterative Proportional Updating (IPU). This procedure was developed by Ye et al. (2009) and it was expanded to accomodate controls at multiple geographic resolutions by Konduri et al. (2016).  </p>
				  <p>The IPU procedure calculates a set of weights of each one of the microdata records in an iterative approach. It is capable of closely matching household-level and person-level marginal distributions at the same time; and it can accommodate control attributes defined at municipality-level or county-level simultaneously. This feature is specially important for our case study, as households by size are only available at the county-level. </p>
                  <p>The IPU procedure is shown in Figure 1. It consists on adjusting the set of weights for each household of the microdata to minimize the error between the control distribution and calculated distributions of each attribute, at each municipality. Therefore, the set of weights will vary within municipalities. The process converges after a variable number of iterations, usually under 500. </p>
                  <img src="images/syntheticPopulation_IPUprocedure.png" width="642" height="518" alt=""/>
<p>Initial set of weights is equal to 1. On the next iterations, weights are updated as: </p>
                  <img src="images/syntheticPopulation_weights.png" width="300" height="50" alt=""/>
<p>Where: w<sub>i,j,m</sub> is the updated weight of household i at municipality m, w<sub>i,j-1,m</sub> is the previous weigth of household i at municipality m, c<sub>k,m</sub> is the contraint of the control attribute k at municipality m, f<sub>i,k,m</sub> is the frequency of the control attribute k on household i at municipality m. Weights are only updated on the households where the frequency of the control attribute is different than zero.</p>
                <p>Weights are updated after considering each control attribute. All attributes, regardless they are household or person level, are treated equally. After all control attributes are considered, we calculate the relative difference in absolute value between the constraint and the calculated distributions, for each attribute. </p>
                <img src="images/syntheticPopulation_errors.png" width="250" height="50" alt=""/>
                
<p>Where: e<sub>k,m</sub> is the error of control attribute k at municipality m,  w<sub>i,j,m</sub> is the updated weight of household i at municipality m, f<sub>i,k,m</sub> is the frequency of the control attribute k on household i at municipality m, c<sub>k,m</sub> is the contraint of the control attribute k at municipality m. </p>
<p>Municipality level attributes update only the set of weights of the corresponding municipality, while county level attributes update the set of weights of all municipalities that are inside the county.  </p>
				<p>The goodness of fit of the set of errors is calculated as the average error (deviation measure value). This value is compared to the previous iteration. If the absolute difference of average deviation values between two full iterations satisfies a set of tolerance criteria, the IPU procedure stops updating sample household weights. The default threshold is set equal to 0.01% and can be modified by the user. Additional stopping criteria include the maximum number of iterations (default value equal to 1,500) and average error threshold (default value of 0.0000001).</p>
                <p>Some modifications has been implemented on the IPU procedure to reduce computational time and memory consumption. Given that the number of zero-value cells of the frequency matrix can be quite large, a collapsed version of the frequency matrix is used for each attribute. This modification minimizes the number of replications to calculate weighted sums and to update the set of weights. Collapsed vectors (or sparse list representations) were previously applied by Pritchard and Miller in 2012; reducing memory requirements to 0.07% for the multizone approach on IPF procedure (iterative proportional fitting).</p>
                <p>&nbsp;</p>
                <h2>Generation of the synthetic population</h2>                
                
                <p> To generate the synthetic population, households of the microdata are randomly drawn from the sample based on their weights at each specific municipality. Once a household is selected for the municipality, it is allocated at one raster cell within the municipality. The probability for each raster cell is the ratio between the population and employment on the raster cell and the total population and employment on the municipality. </p>
                <img src="images/syntheticPopulation_allocation.png" width="650" height="359" alt=""/>
                <p> <img src="images/syntheticPopulation_attributes_FINAL.png" width="330" height="440" alt="" align="right"/> Attributes of each household can be controlled during the optimization procedure or uncontrolled due to lack of data.                
                </p>
                <p>Two examples of uncontrolled attribute are household income, which was available at the microdata but not on the aggregated data; and number of autos, which was only available on the aggregated data.</p>
                <p>Control attributes are directly copied from the microdata into the synthetic population, as well as uncontrolled attributes that are available on the microdata. Other uncontrolled attributes are assigned to each household using Monte Carlo simulations. </p>
               <p> Monte Carlo simulations is a technique that randomly draws one category of the variable based on the relative probability of the categories. Probability distributions can be copied from the aggregated values distributions or can be modeled based on microdata. For example, the number of autos is modelled using the Household Travel Survey in Germany (Mobilität in Deutschland). The model for the number of autos includes household size, number of workers, household income and household location.</p>
                <p> Control and uncontrolled attributes of the synthetic population are summarized on the table.</p>    
                <p>&nbsp;</p>             
                
                <p> Finally, the goodness of fit of the synthetic population is evaluated. Each population synthesis will produce different results, given the randomness on households' selection. Goodness of fit is evaluated for each municipality as the average error of the controlled attributes. </p>
                <img src="images/syntheticPopulation_goodnessOfFit.png" width="269" height="50" alt=""/>
                <p>Where: GOF<sub>m</sub> is the goodness of fit at municipality m, K is the number of controlled attributes, c<sub>i,k,m</sub> is the value of the control attribute k of household i at municipality m, c<sub>k,m</sub> is the contraint of the control attribute k at municipality m. </p>
                </div>
				<div class="contentright">
					<h2>Example of household file</h2>
					<p><img src="images/syntheticPopulation.png" alt="Example of a list with synthetic households" width="150" height="91" align="center"/></p>
					<p>A synthetic population represents line by line every household individually.</p>
                    <p>&nbsp;</p>
                    <p>&nbsp;</p>
                    <h2>Example of population synthesis</h2>
                    <p>We have a census with microdata from 5 households, composed of one or two persons, who can be male or female. The total population has 13 females and 10 males, and 9 single-person households and 7 two-person households. </p>
                    <p>Population synthesis calculates how many of each household from the microdata is required to match the gender and household size distribution of the total population. In this case, 5 of household type 1; 4 of household type 2; etc. </p>
                     <p>&nbsp;</p>             
                  <p>&nbsp;</p>
                    <p>&nbsp;</p>
                    <p>&nbsp;</p>                                        
                    <p>&nbsp;</p>
                  <h2>Example of frequency matrix</h2>
                  <img src="images/syntheticPopulation_frequencyMatrix.png" width="200" height="544" alt=""/>

<p>In the example, household 123456 is a single-person household inhabited by one female older than 64 years, unemployed. </p>
<p>Household 123457 is a two-person household inhabited by one male worker between 29 and 39 years and one female worker between 29 and 39 years.</p>

                    <p>&nbsp;</p>
                    <h2>References of IPU procedure</h2>
                    <p>Ye, X.; Konduri, K.; Pendyala, R.; Sana, B.; Waddell, P. (2009).  <i>A Methodology to Match Distributions of Both Household and Person Attributes in the Generation of Synthetic Populations </i>. 88th Annual Meeting of the Transportation Research Board, Washington, D.C.</p>
                    
                    <p> Konduri, K.; You, D.; Garikapati, V.; Pendyala, R. (2016). <i> Application of an Enhanced Population Synthesis Model that Accommodates Controls at Multiple Geographic Resolutions</i>. 95th Annual Meeting of the Transportation Research Board, Washington, D.C. (Accepted for publication in Transportation Research Record, DOI: 10.3141/2563-08).</p>
                    
                    <p> Pritchard, D.R.; Miller, E.J. (2012).<i> Advances in population: fitting many attributes per agent and fitting to household and person margins simultaneously</i>. Transportation 39, 685-704. DOI: 10.1007/s11116-011-9367-4.</p>
                    <p>&nbsp;</p>
                    
                    <p>&nbsp;</p>
                    <p>&nbsp;</p>
                    <p>&nbsp;</p>                    
                  <h2>Example of collapsed matrix</h2>
                    <img src="images/syntheticPopulation_collapsed matrix.png" width="150" height="404" alt=""/>
<p>The frequency matrix is substituted by three matrices. </p>
<p>The length matrix represents the number of cells different than zero for each attribute. The location matrix indicates the household ID that on which the value is different than zero. Finally, the value matrix indicates the value of the cell. </p>
<p>This approach saves computational time and memory for large frequency matrices with majority of zero-value cells. </p>
                    
                  
                    
                    <p>&nbsp;</p>
                    <h2>Raster cells</h2>
					<p> For transportation modeling and land use analyses, spatial resolution must be higher than municipalities. Municipalities are usually divided in raster cells, where population and land use distributions are homogeneous.</p>
                    <p> We developed a <a href="https://github.com/joem34/munich_zoning_project">gradual zoning algorithm</a> to rasterize the Munich metropolitan area according to population and employment data. Employment was calculated based on land use. </p>
                    <p>Maximum resolution of raster cells is 100x100 m. Raster cells with lower resolution indicate that population and employment are more homogeneous at that area. </p>
                    <p>Boundaries of the raster cells respect the boundaries between municipalities.</p>
			  </div>
				<div style="clear:both;"></div>
			</div>
		</div>
		<div class="footerArea">
			<div class="container"> 
				<div class="copyright">&copy; 2016 Technical University Munich</div>
			</div>
		</div>
		
		<script type="text/javascript">
		<!--
		var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
		//-->
		</script>
	</body>
</html>
